{{ define "authflowv2/__password_policy.html" }}

{{ $lowercase_required := false }}
{{ $uppercase_required := false }}
{{ range .PasswordPolicies }}
  {{ if eq .Name "PasswordUppercaseRequired" }}
    {{ $uppercase_required = true }}
  {{ end }}
  {{ if eq .Name "PasswordLowercaseRequired" }}
    {{ $lowercase_required = true }}
  {{ end }}
{{ end }}
{{ $both_cases_required := and ($uppercase_required) ($lowercase_required) }}
{{ $has_both_cases_key := ($.Translations.HasKey "v2-password-policy-lowercase-and-uppercase") }}

{{ if .PasswordPolicies }}
  <ul class="flex flex-col gap-y-1">
  {{ range .PasswordPolicies }}
    {{ if eq .Name "PasswordBelowGuessableLevel" }}
    <li class="password-policy whitespace-nowrap order-first" data-password-policy-target="policy" data-password-policy-name="strength" data-min-level={{.Info.min_level}}>
      <span class="password-policy__icon material-icons material-icons--filled"></span>
      {{ template "v2-password-policy-strength" }} {{ template "authflowv2/__password_strength_meter.html" (dict "Classname" "w-full")  }}
    </li>
    {{ end }}
    {{ if eq .Name "PasswordTooShort" }}
    <li class="password-policy" data-min-length="{{ .Info.min_length}}" data-password-policy-target="policy" data-password-policy-name="length">
      <span class="password-policy__icon material-icons material-icons--filled"></span>
      {{ template "v2-password-policy-minimum-length" (dict "length" .Info.min_length) }}
    </li>
    {{ end }}
    {{ if (or ($both_cases_required) ($has_both_cases_key)) }}
      {{ if eq .Name "PasswordUppercaseRequired" }}
      <li class="password-policy" data-password-policy-target="policy" data-password-policy-name="uppercase-lowercase">
        <span class="password-policy__icon material-icons material-icons--filled"></span>
        {{ template "v2-password-policy-lowercase-and-uppercase" }}
      </li>
      {{ end }}
    {{ else }}
      {{ if eq .Name "PasswordUppercaseRequired" }}
      <li class="password-policy" data-password-policy-target="policy" data-password-policy-name="uppercase">
        <span class="password-policy__icon material-icons material-icons--filled"></span>
        {{ template "v2-password-policy-uppercase" }}
      </li>
      {{ end }}
      {{ if eq .Name "PasswordLowercaseRequired" }}
      <li class="password-policy" data-password-policy-target="policy" data-password-policy-name="lowercase">
        <span class="password-policy__icon material-icons material-icons--filled"></span>
        {{ template "v2-password-policy-lowercase" }}
      </li>
      {{ end }}
    {{ end }}
    {{ if eq .Name "PasswordAlphabetRequired" }}
    <li class="password-policy" data-password-policy-target="policy" data-password-policy-name="alphabet">
      <span class="password-policy__icon material-icons material-icons--filled"></span>
      {{ template "v2-password-policy-alphabet" }}
    </li>
    {{ end }}
    {{ if eq .Name "PasswordDigitRequired" }}
    <li class="password-policy" data-password-policy-target="policy" data-password-policy-name="digit">
      <span class="password-policy__icon material-icons material-icons--filled"></span>
      {{ template "v2-password-policy-digit" }}
    </li>
    {{ end }}
    {{ if eq .Name "PasswordSymbolRequired" }}
    <li class="password-policy" data-password-policy-target="policy" data-password-policy-name="symbol">
      <span class="password-policy__icon material-icons material-icons--filled"></span>
      {{ template "v2-password-policy-symbol" }}
    </li>
    {{ end }}
  {{ end }}
  </ul>
{{ end }}
{{ end }}
